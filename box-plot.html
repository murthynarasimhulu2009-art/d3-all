<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Box Plot</title>
<script src="https://d3js.org/d3.v7.min.js"></script>
<style>
  body {font-family: sans-serif;}
  .axis path,
  .axis line {stroke: #000;}
  .box {fill: lightblue; stroke: black;}
  .median {stroke: red; stroke-width: 2;}
  .whisker {stroke: black; stroke-width: 1;}
</style>
</head>
<body>
<h2 style="text-align:center;">Box Plot</h2>
<script>
// Data (inline)
const data = [
  {group: "Group A", q1: 25.3, median: 42.7, q3: 58.9, min: 12.1, max: 78.4},
  {group: "Group B", q1: 48.6, median: 65.2, q3: 81.7, min: 34.8, max: 95.3},
  {group: "Group C", q1: 67.9, median: 84.5, q3: 98.2, min: 52.6, max: 112.8}
];

// Dimensions
const width = 600;
const height = 400;
const margin = {top: 20, right: 30, bottom: 40, left: 50};
const innerWidth = width - margin.left - margin.right;
const innerHeight = height - margin.top - margin.bottom;

// Create SVG
const svg = d3.select("body")
  .append("svg")
  .attr("width", width)
  .attr("height", height);

// Scales (per config)
const x = d3.scaleBand()
    .domain(data.map(d => d.group))
    .range([margin.left, width - margin.right])
    .padding(0.2);

const y = d3.scaleLinear()
    .domain([
      d3.min(data, d => d.min),
      d3.max(data, d => d.max)
    ])
    .nice()
    .range([height - margin.bottom, margin.top]); // range [350, 50]

// Axes
svg.append("g")
   .attr("class", "axis")
   .attr("transform", `translate(0,${height - margin.bottom})`)
   .call(d3.axisBottom(x));

svg.append("g")
   .attr("class", "axis")
   .attr("transform", `translate(${margin.left},0)`)
   .call(d3.axisLeft(y));

// Boxes
svg.selectAll(".box")
  .data(data)
  .enter()
  .append("rect")
  .attr("class", "box")
  .attr("x", d => x(d.group) + (x.bandwidth() - 40) / 2) // width 40
  .attr("width", 40)
  .attr("y", d => y(d.q3))
  .attr("height", d => y(d.q1) - y(d.q3)) // positive height
  .attr("fill", "lightblue")
  .attr("stroke", "black");

// Median lines
svg.selectAll(".median")
  .data(data)
  .enter()
  .append("line")
  .attr("class", "median")
  .attr("x1", d => x(d.group) + (x.bandwidth() - 40) / 2)
  .attr("x2", d => x(d.group) + (x.bandwidth() + 40) / 2)
  .attr("y1", d => y(d.median))
  .attr("y2", d => y(d.median))
  .attr("stroke", "red");

// Whiskers (vertical line)
svg.selectAll(".whisker-line")
  .data(data)
  .enter()
  .append("line")
  .attr("class", "whisker")
  .attr("x1", d => x(d.group) + x.bandwidth() / 2)
  .attr("x2", d => x(d.group) + x.bandwidth() / 2)
  .attr("y1", d => y(d.max))
  .attr("y2", d => y(d.min));

// Top whisker caps
svg.selectAll(".whisker-top")
  .data(data)
  .enter()
  .append("line")
  .attr("class", "whisker")
  .attr("x1", d => x(d.group) + (x.bandwidth() - 10) / 2)
  .attr("x2", d => x(d.group) + (x.bandwidth() + 10) / 2)
  .attr("y1", d => y(d.max))
  .attr("y2", d => y(d.max));

// Bottom whisker caps
svg.selectAll(".whisker-bottom")
  .data(data)
  .enter()
  .append("line")
  .attr("class", "whisker")
  .attr("x1", d => x(d.group) + (x.bandwidth() - 10) / 2)
  .attr("x2", d => x(d.group) + (x.bandwidth() + 10) / 2)
  .attr("y1", d => y(d.min))
  .attr("y2", d => y(d.min));

</script>
</body>
</html>