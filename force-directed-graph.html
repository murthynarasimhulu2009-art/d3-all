<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Force-Directed Graph</title>
<script src="https://d3js.org/d3.v7.min.js"></script>
<style>
  body { font-family: sans-serif; }
  .link { stroke: #999; }
  .node { stroke: #fff; cursor: pointer; }
  .title { text-align: center; font-size: 24px; margin-top: 10px; }
</style>
</head>
<body>
<div class="title">Force-Directed Graph</div>
<script>
  // Configuration
  const config = {
    "space": { "width": 800, "height": 600 },
    "data": {
      "nodes": [
        {"id":"node-0","group":1,"size":8.5,"name":"Node 0"},
        {"id":"node-1","group":1,"size":12.3,"name":"Node 1"},
        {"id":"node-2","group":2,"size":6.7,"name":"Node 2"},
        {"id":"node-3","group":2,"size":15.2,"name":"Node 3"},
        {"id":"node-4","group":3,"size":9.8,"name":"Node 4"},
        {"id":"node-5","group":3,"size":11.4,"name":"Node 5"},
        {"id":"node-6","group":4,"size":7.9,"name":"Node 6"},
        {"id":"node-7","group":4,"size":13.6,"name":"Node 7"},
        {"id":"node-8","group":5,"size":10.1,"name":"Node 8"},
        {"id":"node-9","group":5,"size":14.7,"name":"Node 9"}
      ],
      "links": [
        {"source":"node-0","target":"node-1","value":2.5,"weight":0.8},
        {"source":"node-1","target":"node-2","value":4.2,"weight":0.6},
        {"source":"node-2","target":"node-3","value":1.8,"weight":0.9},
        {"source":"node-3","target":"node-4","value":3.7,"weight":0.4},
        {"source":"node-4","target":"node-5","value":5.1,"weight":0.7},
        {"source":"node-5","target":"node-6","value":2.9,"weight":0.5},
        {"source":"node-6","target":"node-7","value":4.6,"weight":0.8},
        {"source":"node-7","target":"node-8","value":1.3,"weight":0.3},
        {"source":"node-8","target":"node-9","value":3.4,"weight":0.6},
        {"source":"node-0","target":"node-5","value":2.1,"weight":0.4}
      ]
    },
    "forceParams": {
      "link": { "distance": 50, "strength": 0.5 },
      "manyBody": { "strength": -300 },
      "center": { "x": 400, "y": 300 }
    }
  };

  const width = config.space.width;
  const height = config.space.height;

  const svg = d3.select("body")
    .append("svg")
    .attr("width", width)
    .attr("height", height);

  // Color scale
  const color = d3.scaleOrdinal(d3.schemeCategory10);

  // Create simulation
  const simulation = d3.forceSimulation(config.data.nodes)
    .force("link", d3.forceLink(config.data.links)
      .id(d => d.id)
      .distance(config.forceParams.link.distance)
      .strength(config.forceParams.link.strength))
    .force("charge", d3.forceManyBody().strength(config.forceParams.manyBody.strength))
    .force("center", d3.forceCenter(config.forceParams.center.x, config.forceParams.center.y))
    .on("tick", ticked);

  // Draw links
  const link = svg.append("g")
    .attr("stroke", "#999")
    .selectAll("line")
    .data(config.data.links)
    .enter()
    .append("line")
    .attr("stroke-width", d => Math.sqrt(d.value));

  // Draw nodes
  const node = svg.append("g")
    .selectAll("circle")
    .data(config.data.nodes)
    .enter()
    .append("circle")
    .attr("r", 5)
    .attr("fill", d => color(d.group))
    .attr("stroke", "#fff")
    .call(drag(simulation));

  // Tick function: update positions
  function ticked() {
    link
      .attr("x1", d => d.source.x)
      .attr("y1", d => d.source.y)
      .attr("x2", d => d.target.x)
      .attr("y2", d => d.target.y);

    node
      .attr("cx", d => d.x)
      .attr("cy", d => d.y);
  }

  // Drag behavior
  function drag(simulation) {
    function dragstarted(event) {
      if (!event.active) simulation.alphaTarget(0.3).restart();
      event.subject.fx = event.x;
      event.subject.fy = event.y;
    }

    function dragged(event) {
      event.subject.fx = event.x;
      event.fy = event.y;
    }

    function dragended(event) {
      if (!event.active) simulation.alphaTarget(0);
      event.subject.fx = null;
      event.fy = null;
    }

    return d3.drag()
      .on("start", dragstarted)
      .on("drag", dragged)
      .on("end", dragended);
  }
</script>
</body>
</html>