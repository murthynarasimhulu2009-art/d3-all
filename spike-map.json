{
  "id": "spike-map",
  "title": "Spike Map",
  "data": {
    "source": {
      "type": "inline",
      "data": [
        {
          "city": "New York",
          "lat": 40.7128,
          "lon": -74.006,
          "population": 8400000
        },
        {
          "city": "Los Angeles",
          "lat": 34.0522,
          "lon": -118.2437,
          "population": 3900000
        },
        {
          "city": "Chicago",
          "lat": 41.8781,
          "lon": -87.6298,
          "population": 2700000
        },
        {
          "city": "Houston",
          "lat": 29.7604,
          "lon": -95.3698,
          "population": 2300000
        },
        {
          "city": "Phoenix",
          "lat": 33.4484,
          "lon": -112.074,
          "population": 1600000
        }
      ]
    },
    "fields": [
      {
        "name": "city",
        "type": "nominal",
        "accessor": "city"
      },
      {
        "name": "lat",
        "type": "quantitative",
        "accessor": "lat"
      },
      {
        "name": "lon",
        "type": "quantitative",
        "accessor": "lon"
      },
      {
        "name": "population",
        "type": "quantitative",
        "accessor": "population"
      }
    ]
  },
  "space": {
    "width": 800,
    "height": 500,
    "coordinates": [
      {
        "id": "map",
        "type": "geographic",
        "projection": {
          "type": "albersUsa",
          "scale": 1000,
          "translate": [
            400,
            250
          ]
        }
      }
    ]
  },
  "scales": {
    "height": {
      "type": "sqrt",
      "domainFrom": {
        "data": "main",
        "field": "population",
        "method": "extent"
      },
      "range": [
        5,
        100
      ]
    },
    "color": {
      "type": "sequential",
      "scheme": "Reds"
    }
  },
  "layers": [
    {
      "id": "spikes",
      "mark": {
        "type": "line"
      },
      "encoding": {
        "x": {
          "field": "lon",
          "transform": [
            {
              "type": "projection"
            }
          ]
        },
        "y": {
          "field": "lat",
          "transform": [
            {
              "type": "projection"
            }
          ]
        },
        "x2": {
          "field": "lon",
          "transform": [
            {
              "type": "projection"
            }
          ]
        },
        "y2": {
          "field": "lat",
          "transform": [
            {
              "type": "projection"
            },
            {
              "type": "offset",
              "params": {
                "offset": "height"
              }
            }
          ]
        },
        "stroke": {
          "field": "population",
          "scale": "color"
        },
        "strokeWidth": {
          "value": 3
        }
      }
    }
  ]
}