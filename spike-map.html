<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Spike Map</title>
<script src="https://cdn.jsdelivr.net/npm/d3@7"></script>
<style>
  body { font-family: sans-serif; margin: 0; padding: 0; }
  .title { font-size: 24px; text-align: center; margin: 10px 0; }
</style>
</head>
<body>
<div class="title">Spike Map</div>
<svg id="spike-map" width="800" height="500"></svg>
<script>
// Inline data
const data = [
  { city: "New York",    lat: 40.7128,  lon: -74.0060,   population: 8400000 },
  { city: "Los Angeles",lat: 34.0522,  lon: -118.2437,  population: 3900000 },
  { city: "Chicago",    lat: 41.8781,  lon: -87.6298,   population: 2700000 },
  { city: "Houston",    lat: 29.7604,  lon: -95.3698,   population: 2300000 },
  { city: "Phoenix",    lat: 33.4484,  lon: -112.0740,  population: 1600000 }
];

// SVG canvas
const width = 800, height = 500;
const svg = d3.select("#spike-map");

// Projection matching config
const projection = d3.geoAlbersUsa()
    .scale(1000)
    .translate([400, 250]);

// Scales
const populationExtent = d3.extent(data, d => d.population);
const heightScale = d3.scaleSqrt()
    .domain(populationExtent)
    .range([5, 100]);

const colorScale = d3.scaleSequential()
    .domain(populationExtent)
    .interpolator(d3.interpolateReds);

// Project points and draw spikes
data.forEach(d => {
  const [x, y] = projection([d.lon, d.lat]);
  const spikeHeight = heightScale(d.population);
  svg.append("line")
    .attr("x1", x)
    .attr("y1", y)
    .attr("x2", x)
    .attr("y2", y + spikeHeight)
    .attr("stroke", colorScale(d.population))
    .attr("stroke-width", 3);
});

// Optional: add simple circles for cities (optional visual aid)
data.forEach(d => {
  const [x, y] = projection([d.lon, d.lat]);
  svg.append("circle")
    .attr("cx", x)
    .attr("cy", y)
    .attr("r", 4)
    .attr("fill", "#333");
});
</script>
</body>
</html>